<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Real time metrics - Butler documentation</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Real time metrics";
    var mkdocs_page_input_path = "real-time.md";
    var mkdocs_page_url = "/real-time/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-58487795-2', 'mountaindude.github.io/butler');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Butler documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../overview/">Overview and features</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting started</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../project-layout/">Project layout</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../install-config/">Installation and configuration</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../running/">Running Butler</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Features</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rest/">REST API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../log-events/">Log event handlers</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Real time metrics</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#real_time_data_on_active_user_sessions">Real time data on active user sessions</a></li>
                
                    <li><a class="toctree-l4" href="#active_users_data_as_mqtt_messages">Active users data as MQTT messages</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../mqtt/">MQTT integration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../udp-client/">UDP client</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../sample-code/">Examples</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../security/">Security considerations</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../tools-used/">Tools used</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Butler documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Real time metrics</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mountaindude/butler" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="real_time_data_on_active_user_sessions">Real time data on active user sessions<a class="headerlink" href="#real_time_data_on_active_user_sessions" title="Permanent link">&para;</a></h1>
<p>Butler listens to session start/end messages from Sense's log4net logging framework, and keeps records of both how many and which users currently have active sessions.<br />
Ideal would be if the Sense APIs would provide a list of currently active users, that us however currently not available. 
For that reason Butler's tactic is to listen to log events to determine when users start and end sessions.   </p>
<p>There is however a downside to this approach.<br />
When Butler is first started, it will not know what sessions are currently active. Instead, it will collect that inforamation as time passes.<br />
This means that the active user count, as well as what specific users are active, might be incorrect when Butler is first started. 
The data will then become more and more exact as users end their sessions, and later restart them (Butler will then capture the session restart, and update its data structures accordingly).</p>
<h2 id="active_users_data_as_mqtt_messages">Active users data as MQTT messages<a class="headerlink" href="#active_users_data_as_mqtt_messages" title="Permanent link">&para;</a></h2>
<p>Butler publishes a set of MQTT messages relating to active sessions.<br />
Whenever a session starts or ends, two MQT messages will be sent:  </p>
<ul>
<li>The new number for number of active user sessions is posted to the MQTT topic defined by the config entry Butler.mqttConfig.activeUserCountTopic</li>
<li>A string array with usernames of all users with active sessions is posted to MQTT topic defined by Butler.mqttConfig.activeUsersTopic</li>
</ul>
<p>Making this data available as MQTT messages, it can then be used in real-time dashboards or for alerting purposes.<br />
For example, using <a href="https://github.com/node-red/node-red-dashboard">Node-RED's dashboard module</a>, it is trivial to create a real-time updating dashboard like this one (showing data for the last few days):</p>
<p><img alt="alt text" src="../img/active_user_sessions.png" title="Active user sessions" />  </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../mqtt/" class="btn btn-neutral float-right" title="MQTT integration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../log-events/" class="btn btn-neutral" title="Log event handlers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mountaindude/butler" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../log-events/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../mqtt/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
